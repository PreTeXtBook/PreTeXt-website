# pretextbook.org

This will become the repository for the home page for PreTeXt, to be hosted at [pretextbook.org](https://pretextbook.org).

## Building strategy

During the transition to this new site, we will use a combination of PreTeXt-CLI building and a bash build script.  Below we outline the build process.

The PreTeXt-CLI allows for multiple targets to be built and to create a custom landing page using Pelican to generate the static landing pages.  The static landing pages live in the `site` directory, which contains `theme` and `pages` directories, as well as a `site.ptx` file that specifies the build configurations for Pelican.  Pelican will transform the `.md` files in `pages`, using the templates in `theme` and place the resulting static html in `output/stage` as part of the `pretext deploy` command.

The `pretext deploy` command will also copy the output from each target listed in `project.ptx` to its specified `deploy-dir` inside `output-stage`.  Then this is all copied to the `gh-pages` branch which is pushed to github.

In addition to the static pages describing PreTeXt, the website contains many HTML and PDF documents generated by PreTeXt.  These are created in two different ways.

1. The CLI builds them as targets listed in `project.ptx`.  Before this is done, the most recent versions of these documents are downloaded from their respective repositories and placed in appropriate folders inside `source`, using the `scripts/fetch_sources.py` python script.
2. `pretext/pretext` builds them as specified in `scripts/build.sh`, placing them inside an appropriate static resources folder inside `site`. (TODO)

## GitHub actions

All of the above process can be automated using github actions.

TODO:

This action should clone the most recent versions of the `pretextbook/pretext` and `pretextbook/pretext-cli` repositories and set up a dev environment to use the latest commits of each, rather than the released version (perhaps this is done by default but can be overriden if there are errors?)